% test.m

close all;
clear;
clc;

% set parameters
k = 3;


%% load data
load('../dataset/ORL_Face_img_cov.mat');


%% perform GRCM k-NN classifier with 
grcm_ev_accuracy = rcm_knn_classifier(TrainSet, TestSet,'GRCM', '2', 'EV', k);
grcm_ev2_accuracy = rcm_knn_classifier(TrainSet, TestSet,'GRCM', '2', 'EV2', k);
grcm_stein_accuracy = rcm_knn_classifier(TrainSet, TestSet,'GRCM', '2', 'Stein', k);
grcm_airm_accuracy = rcm_knn_classifier(TrainSet, TestSet,'GRCM', '2', 'AIRM', k);
grcm_lerm_accuracy = rcm_knn_classifier(TrainSet, TestSet,'GRCM', '2', 'LERM', k);
grcm_frobenius_accuracy = rcm_knn_classifier(TrainSet, TestSet,'GRCM', '2', 'Frobenius', k);

% RCM4 with eigenvalue-based distance
rcm_ev_accuracy = rcm_knn_classifier(TrainSet, TestSet,'RCM', '4', 'EV', k);
rcm_ev2_accuracy = rcm_knn_classifier(TrainSet, TestSet,'RCM', '4', 'EV2', k);
rcm_stein_accuracy = rcm_knn_classifier(TrainSet, TestSet,'RCM', '4', 'Stein', k);
rcm_airm_accuracy = rcm_knn_classifier(TrainSet, TestSet,'RCM', '4', 'AIRM', k);
rcm_lerm_accuracy = rcm_knn_classifier(TrainSet, TestSet,'RCM', '4', 'LERM', k);
rcm_frobenius_accuracy = rcm_knn_classifier(TrainSet, TestSet,'RCM', '4', 'Frobenius', k);



%% 
fprintf('\n\n## Summary of results\n\n')

%% 
fprintf('##  Covariance Type: GRCM\n');
fprintf('##  GRCM: EV Accuracy = %5.2f\n', grcm_ev_accuracy);
fprintf('##  GRCM: EV2 Accuracy = %5.2f\n', grcm_ev2_accuracy);
fprintf('##  GRCM: Stein Accuracy = %5.2f\n', accuracy_GRCM_Stein);
fprintf('##  GRCM: AIRM Accuracy = %5.2f\n', accuracy_GRCM_AIRM);
fprintf('##  GRCM: LERM Accuracy = %5.2f\n', accuracy_GRCM_LERM);
fprintf('##  GRCM: Frobenius Accuracy = %5.2f\n\n', accuracy_GRCM_Frobenius);


fprintf('##  Covariance Type: RCM\n');
fprintf('##  RCM: EV Accuracy = %5.2f %%\n', accuracy_RCM_EV);
fprintf('##  RCM: EV2 Accuracy = %5.2f %%\n', accuracy_RCM_EV2);
fprintf('##  RCM: Stein Accuracy = %5.2f %%\n', accuracy_RCM_Stein);
fprintf('##  RCM: AIRM Accuracy = %5.2f %%\n', accuracy_RCM_AIRM);
fprintf('##  RCM: LERM Accuracy = %5.2f %%\n', accuracy_RCM_LERM);
fprintf('##  RCM: Frobenius Accuracy = %5.2f %%\n', accuracy_RCM_Frobenius);


